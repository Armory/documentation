<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="The amazon-instance Packer builder is able to create Amazon AMIs backed by instance storage as the root device. For more information on the difference between instance storage and EBS-backed instances, see the storage for the root device section in the EC2 documentation. ">

    <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/favicons/apple-touch-icon-955d1d54.png">
    <link rel="icon" type="image/png" href="/assets/images/favicons/favicon-32x32-d497582f.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/assets/images/favicons/favicon-16x16-dbee5574.png" sizes="16x16">
    <link rel="manifest" href="/android-manifest.json">
    <link rel="mask-icon" href="/assets/images/favicons/safari-pinned-tab-132739f6.svg" color="#5bbad5">
    <meta name="msapplication-config" content="/microsoft-tile.xml" />
    <meta name="theme-color" content="#ffffff">

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@HashiCorp" />
    <meta name="twitter:creator" content="@HashiCorp" />
    <meta property="og:url" content="https://www.packer.io/docs/builders/amazon-instance.html" />
    <meta property="og:title" content="Amazon instance-store - Builders - Packer by HashiCorp" />
    <meta property="og:site_name" content="Packer by HashiCorp"/>
    <meta property="og:image" content="https://www.packer.io/assets/images/og-image-c128355d.png"/>
    <meta property="og:image:width" content="1200"/>
    <meta property="og:image:height" content="1200"/>
    <meta property="og:description" content="The amazon-instance Packer builder is able to create Amazon AMIs backed by instance storage as the root device. For more information on the difference between instance storage and EBS-backed instances, see the storage for the root device section in the EC2 documentation. " />

    <title>Amazon instance-store - Builders - Packer by HashiCorp</title>

    <!-- Stylesheets -->
    <link rel="stylesheet" href="https://use.typekit.net/wxf7mfi.css">
    <link href="/assets/stylesheets/application-be886780.css" rel="stylesheet" />

    <!-- Site scripts -->
    <!--[if lt IE 9]><script src="/assets/javascripts/ie-compat-c141a02d.js" defer="defer"></script><![endif]-->
    <script src="/assets/javascripts/application-4188ebc8.js" defer="defer"></script>

    <!-- Analytics scrpts -->
    <script defer>
      !function(){var e=window.analytics=window.analytics||[];if(!e.initialize)if(e.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{e.invoked=!0,e.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on"],e.factory=function(t){return function(){var a=Array.prototype.slice.call(arguments);return a.unshift(t),e.push(a),e}};for(var t=0;t<e.methods.length;t++){var a=e.methods[t];e[a]=e.factory(a)}e.load=function(e){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+e+"/analytics.min.js";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(t,a)},e.SNIPPET_VERSION="4.0.0",e.load("AjXdfmTTk1I9q9dfyePuDFHBrz1tCO3l")}}();var om597a24292a958,om597a24292a958_poll=function(){var e=0;return function(t,a){clearInterval(e),e=setInterval(t,a)}}();!function(e,t,a){if(e.getElementById(a))om597a24292a958_poll(function(){if(window.om_loaded&&!om597a24292a958)return(om597a24292a958=new OptinMonsterApp).init({s:"35109.597a24292a958",staging:0,dev:0,beta:0})},25);else{var n=!1,o=e.createElement("script");o.id=a,o.src="//a.optnmstr.com/app/js/api.min.js",o.async=!0,o.onload=o.onreadystatechange=function(){if(!(n||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState))try{n=om_loaded=!0,(om597a24292a958=new OptinMonsterApp).init({s:"35109.597a24292a958",staging:0,dev:0,beta:0}),o.onload=o.onreadystatechange=null}catch(e){}},(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(o)}}(document,0,"omapi-script");
    </script>

    
  </head>

  <body id="page-docs-builders-amazon-instance" class="layout-docs page-amazon-instance-store-builders">

    <svg class="hidden-print" aria-hidden="true" style="position: absolute; width: 0; height: 0;" width="0" height="0" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <defs>
    <symbol id="mega-nav-icon-angle" viewBox="0 0 13 7">
      <polygon points="6.5,6.5 0.7,1.6 1.3,0.8 6.5,5.2 11.7,0.8 12.3,1.6 "/>
    </symbol>
    <symbol id="mega-nav-icon-close" viewBox="0 0 13 15">
      <path vector-effect="non-scaling-stroke" d="M1.1 14L11.9 1M11.9 14L1.1 1"/>
    </symbol>
  </defs>
</svg>
<div class="hidden-print mega-nav-sandbox">
  <div class="mega-nav-banner">
    <div class="container">
      <div class="mega-nav-banner-item">
        <a class="mega-nav-banner-logo" href="https://www.hashicorp.com"><img src="/assets/images/mega-nav/logo-hashicorp-wordmark-bbed0e8a.svg" alt="HashiCorp Logo" /></a>
      </div>
      <div class="mega-nav-banner-item">
        <p class="mega-nav-tagline"><span class="visible-xs text-muted">Learn the</span><span class="hidden-xs text-muted">Learn how Packer fits into the</span></p>
        <div id="#mega-nav" class="mega-nav">
          <button type="button" id="mega-nav-ctrl" class="mega-nav-ctrl">
            <div class="mega-nav-ctrl-items">
              <img src="/assets/images/mega-nav/logo-hashicorp-a66fda95.svg" alt="HashiCorp Logo" />
              <strong>HashiCorp Suite</strong>
              <span class="mega-nav-icon-outline">
                <svg class="mega-nav-icon mega-nav-icon-angle-right" aria-hidden="true"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#mega-nav-icon-angle"></use></svg><span class="visuallyhidden">Open</span>
              </span>
            </div>
          </button>
          <div id="mega-nav-body-ct" class="mega-nav-body-ct" aria-labelledby="mega-nav-ctrl">
            <div class="mega-nav-body">
              <button type="button" id="mega-nav-close" class="mega-nav-close"><svg class="mega-nav-icon mega-nav-icon-close" aria-hidden="true"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#mega-nav-icon-close"></use></svg><span class="visuallyhidden">Close</span></button>
              <div class="mega-nav-body-header">
                <div class="mega-nav-body-header-item">
                  <h2 class="mega-nav-h1">Provision, Secure, Connect, and&nbsp;Run</h2>
                  <p class="mega-nav-h2">Any infrastructure for any&nbsp;application</p>
                </div>
                <div class="mega-nav-body-header-item">
                  <a href="https://www.hashicorp.com/" class="mega-nav-btn"><img src="/assets/images/mega-nav/logo-hashicorp-a66fda95.svg" alt="HashiCorp Logo" /> Learn the HashiCorp Enterprise&nbsp;Suite <svg class="mega-nav-icon mega-nav-icon-angle-right" aria-hidden="true"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#mega-nav-icon-angle"></use></svg></a>
                </div>
              </div>
              <div class="mega-nav-body-grid">
                <div class="mega-nav-body-grid-item">
                  <h3 class="mega-nav-h3">Provision</h3>
                  <ul class="mega-nav-grid">
                    <li>
                      <a href="https://www.vagrantup.com" class="mega-nav-grid-item mega-nav-grid-item-vagrant">
                        <div class="mega-nav-grid-item-img">
                          <img src="/assets/images/mega-nav/logo-vagrant-a7ab5898.svg" alt="Vagrant Logo" />
                        </div>
                        <b>Vagrant</b>
                        <ul>
                          <li><span class="mega-nav-tag">Build</span></li>
                          <li><span class="mega-nav-tag">Test</span></li>
                        </ul>
                      </a>
                    </li>
                    <li>
                      <a href="https://www.packer.io" class="mega-nav-grid-item mega-nav-grid-item-packer">
                        <div class="mega-nav-grid-item-img">
                          <img src="/assets/images/mega-nav/logo-packer-cb3b9b94.svg" alt="Packer Logo" />
                        </div>
                        <b>Packer</b>
                        <ul>
                          <li><span class="mega-nav-tag">Package</span></li>
                        </ul>
                      </a>
                    </li>
                    <li>
                      <a href="https://www.terraform.io" class="mega-nav-grid-item mega-nav-grid-item-terraform">
                        <div class="mega-nav-grid-item-img">
                          <img src="/assets/images/mega-nav/logo-terraform-ff69eaae.svg" alt="Terraform Logo" />
                        </div>
                        <b>Terraform</b>
                        <ul>
                          <li><span class="mega-nav-tag">Provision</span></li>
                        </ul>
                      </a>
                    </li>
                  </ul>
                </div>
                <div class="mega-nav-body-grid-item">
                  <h3 class="mega-nav-h3">Secure</h3>
                  <ul class="mega-nav-grid">
                    <li>
                      <a href="https://www.vaultproject.io" class="mega-nav-grid-item mega-nav-grid-item-vault">
                        <div class="mega-nav-grid-item-img">
                          <img src="/assets/images/mega-nav/logo-vault-0f83e3d2.svg" alt="Vault Logo" />
                        </div>
                        <b>Vault</b>
                        <ul>
                          <li><span class="mega-nav-tag">Secure</span></li>
                        </ul>
                      </a>
                    </li>
                  </ul>
                </div>
                <div class="mega-nav-body-grid-item">
                  <h3 class="mega-nav-h3">Connect</h3>
                  <ul class="mega-nav-grid">
                    <li>
                      <a href="https://www.consul.io" class="mega-nav-grid-item mega-nav-grid-item-consul">
                        <div class="mega-nav-grid-item-img">
                          <img src="/assets/images/mega-nav/logo-consul-c77f6844.svg" alt="Consul Logo" />
                        </div>
                        <b>Consul</b>
                        <ul>
                          <li><span class="mega-nav-tag">Connect</span></li>
                        </ul>
                      </a>
                    </li>
                  </ul>
                </div>
                <div class="mega-nav-body-grid-item">
                  <h3 class="mega-nav-h3">Run</h3>
                  <ul class="mega-nav-grid">
                    <li>
                      <a href="https://www.nomadproject.io" class="mega-nav-grid-item mega-nav-grid-item-nomad">
                        <div class="mega-nav-grid-item-img">
                          <img src="/assets/images/mega-nav/logo-nomad-c4c148be.svg" alt="Nomad Logo" />
                        </div>
                        <b>Nomad</b>
                        <ul>
                          <li><span class="mega-nav-tag">Run</span></li>
                        </ul>
                      </a>
                    </li>
                  </ul>
                </div>
              </div>
              <div class="mega-nav-body-footer">
                <p>Seven elements of the modern Application Lifecycle</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


    <div id="header" class="navigation navbar-static-top hidden-print">
      <div class="container">
        <div class="row">
          <div class="col-xs-12">
            <div class="navbar-header">
              <div class="navbar-brand">
                <a href="/">
                  <svg xmlns="http://www.w3.org/2000/svg" viewbox="423 368 142 54" class="logo" height="50">
  <path class="p-front" fill="#1DAEFF" d="M423.046 374.78l17.42 9.96v36.717l-17.42-9.958"></path>
  <path class="p-back" fill="#1D94DD" d="M449.09 379.072l-18.935-10.79v7.493l12.876 7.356v22.485l6.06 3.443c3.75 2.14 6.82.858 6.82-2.85V389.71c0-3.71-3.07-8.497-6.82-10.638"></path>
  <path class="text" fill="#000000" d="M479.05 387.476h-4.55v8.194h4.55c2.542 0 3.294-.935 3.294-2.912v-2.443c0-1.977-.823-2.84-3.295-2.84zm-9.063-3.99h9.312c5.513 0 7.554 2.264 7.554 6.47v3.27c0 4.17-2.22 6.432-7.772 6.432H474.5v7.764h-4.513v-23.935zm28.12 17.324h-3.225c-1.433 0-1.827.394-1.827 1.725 0 1.22.394 1.76 1.755 1.76 1.29 0 2.472-.43 3.296-.898v-2.588zm4.37 6.612h-3.583l-.323-1.186c-1.572 1.042-3.433 1.546-5.19 1.546-3.19 0-4.55-2.193-4.55-5.212 0-3.557 1.54-4.923 5.088-4.923h4.19v-1.833c0-1.94-.537-2.624-3.33-2.624-1.576 0-3.295.216-4.835.54l-.536-3.343c1.647-.503 4.046-.827 5.98-.827 5.48 0 7.092 1.94 7.092 6.326v11.536zm3.15-6.362v-4.78c0-4.707 2.04-6.72 7.524-6.72 1.22 0 2.976.216 4.265.647l-.537 3.594c-1.182-.32-2.757-.463-3.618-.463-2.508 0-3.26.755-3.26 2.91v4.853c0 2.155.752 2.91 3.26 2.91 1.11 0 2.363-.144 3.617-.467l.537 3.595c-1.146.394-2.83.646-4.26.646-5.483 0-7.524-2.01-7.524-6.72m29.905-11.143l-5.12 8.66 5.335 8.845h-4.8l-5.264-8.842 4.98-8.66h4.87zm-14.827 17.505V382.77l4.37-.61v25.264h-4.37zm20.702-10.603h5.553v-.86c0-1.655-.5-2.805-2.65-2.805s-2.902 1.15-2.902 2.804v.86zm3.403 7.37c1.683 0 3.44-.254 5.337-.83l.68 3.308c-1.97.755-4.334 1.114-6.41 1.114-5.48 0-7.378-2.55-7.378-6.754v-4.636c0-3.703 1.647-6.83 7.235-6.83 5.586 0 6.84 3.27 6.84 7.044v3.738h-9.706v.9c0 2.118.756 2.946 3.406 2.946zm18.52-10.604c-1.684.755-3.045 1.546-4.62 2.552v11.285h-4.37V389.92h3.69l.284 1.94c.968-.646 3.045-1.868 4.585-2.3l.43 4.025z"></path>
</svg>

                </a>
              </div>
              <button class="navbar-toggle" type="button">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
            </div>
            <div class="buttons hidden-xs">
              <nav class="navigation-links" role="navigation">
                <ul class="main-links nav navbar-nav navbar-right">
                  <li><a href="/intro/index.html">Intro</a></li>
                  <li><a href="/guides/index.html">Guides</a></li>
                  <li><a href="/docs/index.html">Docs</a></li>
                  <li><a href="/community.html">Community</a></li>
                  <li>
                    <a href="/downloads.html">
                      <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewbox="0 0 28 28" enable-background="new 0 0 28 28" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve">
  <path d="M28 0H0v28h28V0zM13.8 22.9L7 17.3l2-2.4 3.2 2.6V7h3.2v10.5l3.2-2.6 2 2.4L13.8 22.9z"></path>
</svg>
 Download
                    </a>
                  </li>
                  <li>
                    <a href="https://github.com/hashicorp/packer">
                      <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewbox="0 0 28 28" enable-background="new 0 0 28 28" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve">
  <path d="M28 0H0v28h11.4c0 0 0-1.3 0-2.4C7.7 26.4 7 23.9 7 23.9 6.4 22.4 5.5 22 5.5 22c-1.2-0.8 0.1-0.8 0.1-0.8 1.3 0.1 2 1.4 2 1.4 1.2 2 3 1.4 3.8 1.1 0.1-0.8 0.5-1.4 0.9-1.8 -2.9-0.3-6-1.5-6-6.5 0-1.4 0.5-2.6 1.3-3.5C7.5 11.5 7 10.2 7.8 8.4c0 0 1.1-0.4 3.6 1.3 1-0.3 2.2-0.4 3.3-0.4 1.1 0 2.2 0.2 3.3 0.4 2.5-1.7 3.6-1.3 3.6-1.3 0.7 1.8 0.3 3.1 0.1 3.5 0.8 0.9 1.3 2.1 1.3 3.5 0 5-3.1 6.1-6 6.5 0.5 0.4 0.9 1.2 0.9 2.4 0 1.8 0 3.7 0 3.7H28V0z"></path>
</svg>
 GitHub
                    </a>
                  </li>
                </ul>
              </nav>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="sidebar-overlay"></div>

<aside class="sidebar" role="navigation">
  <div class="sidebar-header">
    <svg xmlns="http://www.w3.org/2000/svg" viewbox="423 368 142 54" class="logo" height="42">
  <path class="p-front" fill="#1DAEFF" d="M423.046 374.78l17.42 9.96v36.717l-17.42-9.958"></path>
  <path class="p-back" fill="#1D94DD" d="M449.09 379.072l-18.935-10.79v7.493l12.876 7.356v22.485l6.06 3.443c3.75 2.14 6.82.858 6.82-2.85V389.71c0-3.71-3.07-8.497-6.82-10.638"></path>
  <path class="text" fill="#000000" d="M479.05 387.476h-4.55v8.194h4.55c2.542 0 3.294-.935 3.294-2.912v-2.443c0-1.977-.823-2.84-3.295-2.84zm-9.063-3.99h9.312c5.513 0 7.554 2.264 7.554 6.47v3.27c0 4.17-2.22 6.432-7.772 6.432H474.5v7.764h-4.513v-23.935zm28.12 17.324h-3.225c-1.433 0-1.827.394-1.827 1.725 0 1.22.394 1.76 1.755 1.76 1.29 0 2.472-.43 3.296-.898v-2.588zm4.37 6.612h-3.583l-.323-1.186c-1.572 1.042-3.433 1.546-5.19 1.546-3.19 0-4.55-2.193-4.55-5.212 0-3.557 1.54-4.923 5.088-4.923h4.19v-1.833c0-1.94-.537-2.624-3.33-2.624-1.576 0-3.295.216-4.835.54l-.536-3.343c1.647-.503 4.046-.827 5.98-.827 5.48 0 7.092 1.94 7.092 6.326v11.536zm3.15-6.362v-4.78c0-4.707 2.04-6.72 7.524-6.72 1.22 0 2.976.216 4.265.647l-.537 3.594c-1.182-.32-2.757-.463-3.618-.463-2.508 0-3.26.755-3.26 2.91v4.853c0 2.155.752 2.91 3.26 2.91 1.11 0 2.363-.144 3.617-.467l.537 3.595c-1.146.394-2.83.646-4.26.646-5.483 0-7.524-2.01-7.524-6.72m29.905-11.143l-5.12 8.66 5.335 8.845h-4.8l-5.264-8.842 4.98-8.66h4.87zm-14.827 17.505V382.77l4.37-.61v25.264h-4.37zm20.702-10.603h5.553v-.86c0-1.655-.5-2.805-2.65-2.805s-2.902 1.15-2.902 2.804v.86zm3.403 7.37c1.683 0 3.44-.254 5.337-.83l.68 3.308c-1.97.755-4.334 1.114-6.41 1.114-5.48 0-7.378-2.55-7.378-6.754v-4.636c0-3.703 1.647-6.83 7.235-6.83 5.586 0 6.84 3.27 6.84 7.044v3.738h-9.706v.9c0 2.118.756 2.946 3.406 2.946zm18.52-10.604c-1.684.755-3.045 1.546-4.62 2.552v11.285h-4.37V389.92h3.69l.284 1.94c.968-.646 3.045-1.868 4.585-2.3l.43 4.025z"></path>
</svg>

  </div>

  <ul class="nav sidebar-nav">
    <li><a href="/intro/index.html">Intro</a></li>
    <li><a href="/guides/index.html">Guides</a></li>
    <li><a href="/docs/index.html">Docs</a></li>
    <li><a href="/community.html">Community</a></li>
    <li><a href="/assets/files/press-kit.zip">Press Kit</a></li>
  </ul>

  <div class="divider"></div>

  <ul class="external nav sidebar-nav">
    <li>
      <a href="/downloads.html">
        <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewbox="0 0 28 28" enable-background="new 0 0 28 28" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve">
  <path d="M28 0H0v28h28V0zM13.8 22.9L7 17.3l2-2.4 3.2 2.6V7h3.2v10.5l3.2-2.6 2 2.4L13.8 22.9z"></path>
</svg>
 Download
      </a>
    </li>
    <li>
      <a href="https://github.com/hashicorp/packer">
        <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewbox="0 0 28 28" enable-background="new 0 0 28 28" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve">
  <path d="M28 0H0v28h11.4c0 0 0-1.3 0-2.4C7.7 26.4 7 23.9 7 23.9 6.4 22.4 5.5 22 5.5 22c-1.2-0.8 0.1-0.8 0.1-0.8 1.3 0.1 2 1.4 2 1.4 1.2 2 3 1.4 3.8 1.1 0.1-0.8 0.5-1.4 0.9-1.8 -2.9-0.3-6-1.5-6-6.5 0-1.4 0.5-2.6 1.3-3.5C7.5 11.5 7 10.2 7.8 8.4c0 0 1.1-0.4 3.6 1.3 1-0.3 2.2-0.4 3.3-0.4 1.1 0 2.2 0.2 3.3 0.4 2.5-1.7 3.6-1.3 3.6-1.3 0.7 1.8 0.3 3.1 0.1 3.5 0.8 0.9 1.3 2.1 1.3 3.5 0 5-3.1 6.1-6 6.5 0.5 0.4 0.9 1.2 0.9 2.4 0 1.8 0 3.7 0 3.7H28V0z"></path>
</svg>
 GitHub
      </a>
    </li>
  </ul>
</aside>


    <div class="container">
  <div class="row">
    <div id="docs-sidebar" class="col-sm-3 col-md-3 col-xs-12 hidden-print" role="complementary">
          <ul class="nav docs-sidenav">
      <li>
        <a href="/docs/install/index.html">Installing Packer</a>
      </li>
      <li><a href="/docs/basics/terminology.html">Terminology</a></li>

      <li>
        <a href="/docs/commands/index.html">Commands (CLI)</a>
        <ul class="nav">
          <li>
            <a href="/docs/commands/build.html"><tt>build</tt></a>
          </li>
          <li>
            <a href="/docs/commands/fix.html"><tt>fix</tt></a>
          </li>
          <li>
            <a href="/docs/commands/inspect.html"><tt>inspect</tt></a>
          </li>
          <li>
            <a href="/docs/commands/validate.html"><tt>validate</tt></a>
          </li>
        </ul>
      </li>

      <li>
        <a href="/docs/templates/index.html">Templates</a>
        <ul class="nav">
          <li>
            <a href="/docs/templates/builders.html">Builders</a>
          </li>
          <li>
            <a href="/docs/templates/communicator.html">Communicators</a>
          </li>
          <li>
            <a href="/docs/templates/engine.html">Engine</a>
          </li>
          <li>
            <a href="/docs/templates/post-processors.html">Post-Processors</a>
          </li>
          <li>
            <a href="/docs/templates/provisioners.html">Provisioners</a>
          </li>
          <li>
            <a href="/docs/templates/user-variables.html">User Variables</a>
          </li>
        </ul>
      </li>

      <hr>

      <li class="active">
        <a href="/docs/builders/index.html">Builders</a>
        <ul class="nav">
          <li>
             <a href="/docs/builders/alicloud-ecs.html">Alicloud ECS</a>
          </li>
          <li class="active">
            <a href="/docs/builders/amazon.html">Amazon EC2</a>
            <ul class="nav">
              <li>
                <a href="/docs/builders/amazon-chroot.html">chroot</a>
              </li>
              <li>
                <a href="/docs/builders/amazon-ebs.html">EBS</a>
              </li>
              <li>
                <a href="/docs/builders/amazon-ebssurrogate.html">EBS Surrogate</a>
              </li>
              <li>
                <a href="/docs/builders/amazon-ebsvolume.html">EBS Volume</a>
              </li>
              <li class="active">
                <a href="/docs/builders/amazon-instance.html">Instance</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="/docs/builders/azure.html">Azure</a>
            <ul class="nav">
              <li>
                <a href="/docs/builders/azure-setup.html">Setup</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="/docs/builders/cloudstack.html">CloudStack</a>
          </li>
          <li>
            <a href="/docs/builders/digitalocean.html">DigitalOcean</a>
          </li>
          <li>
            <a href="/docs/builders/docker.html">Docker</a>
          </li>
          <li>
            <a href="/docs/builders/file.html">File</a>
          </li>
          <li>
            <a href="/docs/builders/googlecompute.html">Google Cloud</a>
          </li>
          <li>
             <a href="/docs/builders/hetzner-cloud.html">Hetzner Cloud</a>
          </li>
          <li>
            <a href="/docs/builders/hyperv.html">Hyper-V</a>
            <ul class="nav">
              <li>
                <a href="/docs/builders/hyperv-iso.html">ISO</a>
              </li>
              <li>
                <a href="/docs/builders/hyperv-vmcx.html">VMCX</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="/docs/builders/lxc.html">LXC</a>
          </li>
          <li>
            <a href="/docs/builders/lxd.html">LXD</a>
          </li>
          <li>
            <a href="/docs/builders/ncloud.html">NAVER Cloud</a>
          </li>
          <li>
            <a href="/docs/builders/null.html">Null</a>
          </li>
          <li>
            <a href="/docs/builders/oneandone.html">1&amp;1</a>
          </li>
          <li>
            <a href="/docs/builders/openstack.html">OpenStack</a>
          </li>
          <li>
            <a href="/docs/builders/oracle.html">Oracle</a>
            <ul class="nav">
              <li>
                <a href="/docs/builders/oracle-classic.html">Oracle Classic</a>
              </li>
              <li>
                <a href="/docs/builders/oracle-oci.html">Oracle OCI</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="/docs/builders/parallels.html">Parallels</a>
            <ul class="nav">
              <li>
                <a href="/docs/builders/parallels-iso.html">ISO</a>
              </li>
              <li>
                <a href="/docs/builders/parallels-pvm.html">PVM</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="/docs/builders/profitbricks.html">ProfitBricks</a>
          </li>
          <li>
            <a href="/docs/builders/qemu.html">QEMU</a>
          </li>
          <li>
            <a href="/docs/builders/scaleway.html">Scaleway</a>
          </li>
          <li>
            <a href="/docs/builders/triton.html">Triton</a>
          </li>
          <li>
            <a href="/docs/builders/virtualbox.html">VirtualBox</a>
            <ul class="nav">
              <li>
                <a href="/docs/builders/virtualbox-iso.html">ISO</a>
              </li>
              <li>
                <a href="/docs/builders/virtualbox-ovf.html">OVF</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="/docs/builders/vmware.html">VMware</a>
            <ul class="nav">
              <li>
                <a href="/docs/builders/vmware-iso.html">ISO</a>
              </li>
              <li>
                <a href="/docs/builders/vmware-vmx.html">VMX</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="/docs/builders/custom.html">Custom</a>
          </li>
        </ul>
      </li>
      <li>
        <a href="/docs/provisioners/index.html">Provisioners</a>
        <ul class="nav">
          <li>
            <a href="/docs/provisioners/ansible-local.html">Ansible Local</a>
          </li>
          <li>
            <a href="/docs/provisioners/ansible.html">Ansible Remote</a>
          </li>
          <li>
            <a href="/docs/provisioners/breakpoint.html">Breakpoint</a>
          </li>
          <li>
            <a href="/docs/provisioners/chef-client.html">Chef Client</a>
          </li>
          <li>
            <a href="/docs/provisioners/chef-solo.html">Chef Solo</a>
          </li>
          <li>
            <a href="/docs/provisioners/converge.html">Converge</a>
          </li>
          <li>
            <a href="/docs/provisioners/file.html">File</a>
          </li>
          <li>
            <a href="/docs/provisioners/powershell.html">PowerShell</a>
          </li>
          <li>
            <a href="/docs/provisioners/puppet-masterless.html">Puppet Masterless</a>
          </li>
          <li>
            <a href="/docs/provisioners/puppet-server.html">Puppet Server</a>
          </li>
          <li>
            <a href="/docs/provisioners/salt-masterless.html">Salt Masterless</a>
          </li>
          <li>
            <a href="/docs/provisioners/shell.html">Shell</a>
          </li>
          <li>
            <a href="/docs/provisioners/shell-local.html">Shell (Local)</a>
          </li>
          <li>
            <a href="/docs/provisioners/windows-shell.html">Windows Shell</a>
          </li>
          <li>
            <a href="/docs/provisioners/windows-restart.html">Windows Restart</a>
          </li>
          <li>
            <a href="/docs/provisioners/custom.html">Custom</a>
          </li>
        </ul>
      </li>
      <li>
        <a href="/docs/post-processors/index.html">Post-Processors</a>
        <ul class="nav">
          <li>
              <a href="/docs/post-processors/alicloud-import.html">Alicloud Import</a>
          </li>
          <li>
            <a href="/docs/post-processors/amazon-import.html">Amazon Import</a>
          </li>
          <li>
            <a href="/docs/post-processors/artifice.html">Artifice</a>
          </li>
          <li>
            <a href="/docs/post-processors/compress.html">Compress</a>
          </li>
          <li>
            <a href="/docs/post-processors/checksum.html">Checksum</a>
          </li>
          <li>
            <a href="/docs/post-processors/docker-import.html">Docker Import</a>
          </li>
          <li>
            <a href="/docs/post-processors/docker-push.html">Docker Push</a>
          </li>
          <li>
            <a href="/docs/post-processors/docker-save.html">Docker Save</a>
          </li>
          <li>
            <a href="/docs/post-processors/docker-tag.html">Docker Tag</a>
          </li>
          <li>
            <a href="/docs/post-processors/googlecompute-export.html">Google Compute Export</a>
          </li>
          <li>
            <a href="/docs/post-processors/googlecompute-import.html">Google Compute Import</a>
          </li>
          <li>
            <a href="/docs/post-processors/manifest.html">Manifest</a>
          </li>
          <li>
            <a href="/docs/post-processors/shell-local.html">Shell (Local)</a>
          </li>
          <li>
            <a href="/docs/post-processors/vagrant.html">Vagrant</a>
          </li>
          <li>
            <a href="/docs/post-processors/vagrant-cloud.html">Vagrant Cloud</a>
          </li>
          <li>
            <a href="/docs/post-processors/vsphere.html">vSphere</a>
          </li>
          <li>
            <a href="/docs/post-processors/vsphere-template.html">vSphere Template</a>
          </li>
        </ul>
      </li>

      <hr>

      <li>
        <a href="/docs/extending/index.html">Extending Packer</a>
        <ul class="nav">
          <li>
            <a href="/docs/extending/plugins.html">Plugins</a>
          </li>
          <li>
            <a href="/docs/extending/custom-builders.html">Custom Builders</a>
          </li>
          <li>
            <a href="/docs/extending/custom-post-processors.html">Custom Post-Processors</a>
          </li>
          <li>
            <a href="/docs/extending/custom-provisioners.html">Custom Provisioners</a>
          </li>
        </ul>
      </li>

      <hr>

      <li>
        <a href="/docs/other/environment-variables.html">Environment Variables</a>
      </li>
      <li >
        <a href="/docs/other/core-configuration.html">Core Configuration</a>
      </li>
      <li>
        <a href="/docs/other/debugging.html">Debugging</a>
      </li>
    </ul>

    </div>

    <div id="inner" class="col-sm-9 col-md-9 col-xs-12" role="main">
      
  <h1 id="ami-builder-instance-store-">
  <a name="ami-builder-instance-store-" class="anchor" href="#ami-builder-instance-store-">&raquo;</a>
  AMI Builder (instance-store)
</h1>
<p>Type: <code>amazon-instance</code></p>
<p>The <code>amazon-instance</code> Packer builder is able to create Amazon AMIs backed by
instance storage as the root device. For more information on the difference
between instance storage and EBS-backed instances, see the <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ComponentsAMIs.html#storage-for-the-root-device">&quot;storage for the
root device&quot; section in the EC2
documentation</a>.</p>
<p>This builder builds an AMI by launching an EC2 instance from an existing
instance-storage backed AMI, provisioning that running machine, and then
bundling and creating a new AMI from that machine. This is all done in your own
AWS account. This builder will create temporary key pairs, security group
rules, etc. that provide it temporary access to the instance while the image is
being created. This simplifies configuration quite a bit.</p>
<p>This builder does <em>not</em> manage AMIs. Once it creates an AMI and stores it in
your account, it is up to you to use, delete, etc. the AMI.</p>
<div class="alert alert-info" role="alert">
<p><strong>Note:</strong> Temporary resources are, by default, all created with the
prefix <code>packer</code>. This can be useful if you want to restrict the security groups
and key pairs packer is able to operate on.</p>
</div>
<div class="alert alert-info" role="alert">
<p><strong>Note:</strong> This builder requires that the <a href="https://aws.amazon.com/developertools/368">Amazon EC2 AMI
Tools</a> are installed onto the
machine. This can be done within a provisioner, but must be done before the
builder finishes running.</p>
</div>
<div class="alert alert-warning" role="alert">
<p>Instance builds are not supported for Windows. Use
<a href="/docs/builders/amazon-ebs.html"><code>amazon-ebs</code></a> instead.</p>
</div>
<h2 id="configuration-reference">
  <a name="configuration-reference" class="anchor" href="#configuration-reference">&raquo;</a>
  Configuration Reference
</h2>
<p>There are many configuration options available for this builder. They are
segmented below into two categories: required and optional parameters. Within
each category, the available configuration keys are alphabetized.</p>
<p>In addition to the options listed here, a
<a href="/docs/templates/communicator.html">communicator</a> can be configured for this
builder.</p>
<h3 id="required-">
  <a name="required-" class="anchor" href="#required-">&raquo;</a>
  Required:
</h3>

<ul>
<li><p><a name="access_key" /><a href="#access_key"><code>access_key</code></a> (string) - The access key used to communicate with AWS. <a href="/docs/builders/amazon.html#specifying-amazon-credentials">Learn
how to set this.</a></p>
</li>
<li><p><a name="account_id" /><a href="#account_id"><code>account_id</code></a> (string) - Your AWS account ID. This is required for bundling
the AMI. This is <em>not the same</em> as the access key. You can find your
account ID in the security credentials page of your AWS account.</p>
</li>
<li><p><a name="ami_name" /><a href="#ami_name"><code>ami_name</code></a> (string) - The name of the resulting AMI that will appear when
managing AMIs in the AWS console or via APIs. This must be unique. To help
make this unique, use a function like <code>timestamp</code> (see <a href="/docs/templates/engine.html">configuration
templates</a> for more info)</p>
</li>
<li><p><a name="instance_type" /><a href="#instance_type"><code>instance_type</code></a> (string) - The EC2 instance type to use while building the
AMI, such as <code>m1.small</code>.</p>
</li>
<li><p><a name="region" /><a href="#region"><code>region</code></a> (string) - The name of the region, such as <code>us-east-1</code>, in which
to launch the EC2 instance to create the AMI.</p>
</li>
<li><p><a name="s3_bucket" /><a href="#s3_bucket"><code>s3_bucket</code></a> (string) - The name of the S3 bucket to upload the AMI. This
bucket will be created if it doesn&#39;t exist.</p>
</li>
<li><p><a name="secret_key" /><a href="#secret_key"><code>secret_key</code></a> (string) - The secret key used to communicate with AWS. <a href="/docs/builders/amazon.html#specifying-amazon-credentials">Learn
how to set this.</a></p>
</li>
<li><p><a name="source_ami" /><a href="#source_ami"><code>source_ami</code></a> (string) - The initial AMI used as a base for the newly
created machine.</p>
</li>
<li><p><a name="x509_cert_path" /><a href="#x509_cert_path"><code>x509_cert_path</code></a> (string) - The local path to a valid X509 certificate for
your AWS account. This is used for bundling the AMI. This X509 certificate
must be registered with your account from the security credentials page in
the AWS console.</p>
</li>
<li><p><a name="x509_key_path" /><a href="#x509_key_path"><code>x509_key_path</code></a> (string) - The local path to the private key for the X509
certificate specified by <code>x509_cert_path</code>. This is used for bundling the
AMI.</p>
</li>
</ul>
<h3 id="optional-">
  <a name="optional-" class="anchor" href="#optional-">&raquo;</a>
  Optional:
</h3>

<ul>
<li><p><a name="ami_block_device_mappings" /><a href="#ami_block_device_mappings"><code>ami_block_device_mappings</code></a> (array of block device mappings) - Add one or
more <a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/block-device-mapping-concepts.html">block device
mappings</a>
to the AMI. These will be attached when booting a new instance from your
AMI. To add a block device during the Packer build see
<code>launch_block_device_mappings</code> below. Your options here may vary depending
on the type of VM you use. The block device mappings allow for the
following configuration:</p>

<ul>
<li>  <code>delete_on_termination</code> (boolean) - Indicates whether the EBS volume is
deleted on instance termination. Default <code>false</code>. <strong>NOTE</strong>: If this
value is not explicitly set to <code>true</code> and volumes are not cleaned up by
an alternative method, additional volumes will accumulate after every
build.
</li>
<li>  <code>device_name</code> (string) - The device name exposed to the instance (for
example, <code>/dev/sdh</code> or <code>xvdh</code>). Required for every device in the block
device mapping.
</li>
<li>  <code>encrypted</code> (boolean) - Indicates whether to encrypt the volume or not
</li>
<li>  <code>iops</code> (number) - The number of I/O operations per second (IOPS) that
the volume supports. See the documentation on
<a href="https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_EbsBlockDevice.html">IOPs</a>
for more information
</li>
<li>  <code>no_device</code> (boolean) - Suppresses the specified device included in the
block device mapping of the AMI
</li>
<li>  <code>snapshot_id</code> (string) - The ID of the snapshot
</li>
<li>  <code>virtual_name</code> (string) - The virtual device name. See the
documentation on <a href="https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_BlockDeviceMapping.html">Block Device
Mapping</a>
for more information
</li>
<li>  <code>volume_size</code> (number) - The size of the volume, in GiB. Required if
not specifying a <code>snapshot_id</code>
</li>
<li>  <code>volume_type</code> (string) - The volume type. <code>gp2</code> for General Purpose
(SSD) volumes, <code>io1</code> for Provisioned IOPS (SSD) volumes, and <code>standard</code>
for Magnetic volumes
</li>
</ul>
</li>
<li><p><a name="ami_description" /><a href="#ami_description"><code>ami_description</code></a> (string) - The description to set for the resulting
AMI(s). By default this description is empty. This is a <a href="/docs/templates/engine.html">template
engine</a>, see <a href="#build-template-data">Build template
data</a> for more information.</p>
</li>
<li><p><a name="ami_groups" /><a href="#ami_groups"><code>ami_groups</code></a> (array of strings) - A list of groups that have access to
launch the resulting AMI(s). By default no groups have permission to launch
the AMI. <code>all</code> will make the AMI publicly accessible. AWS currently doesn&#39;t
accept any value other than <code>all</code>.</p>
</li>
<li><p><a name="ami_product_codes" /><a href="#ami_product_codes"><code>ami_product_codes</code></a> (array of strings) - A list of product codes to
associate with the AMI. By default no product codes are associated with the
AMI.</p>
</li>
<li><p><a name="ami_regions" /><a href="#ami_regions"><code>ami_regions</code></a> (array of strings) - A list of regions to copy the AMI to.
Tags and attributes are copied along with the AMI. AMI copying takes time
depending on the size of the AMI, but will generally take many minutes.</p>
</li>
<li><p><a name="ami_users" /><a href="#ami_users"><code>ami_users</code></a> (array of strings) - A list of account IDs that have access to
launch the resulting AMI(s). By default no additional users other than the
user creating the AMI has permissions to launch it.</p>
</li>
<li><p><a name="ami_virtualization_type" /><a href="#ami_virtualization_type"><code>ami_virtualization_type</code></a> (string) - The type of virtualization for the AMI
you are building. This option is required to register HVM images. Can be
<code>paravirtual</code> (default) or <code>hvm</code>.</p>
</li>
<li><p><a name="associate_public_ip_address" /><a href="#associate_public_ip_address"><code>associate_public_ip_address</code></a> (boolean) - If using a non-default VPC,
public IP addresses are not provided by default. If this is toggled, your
new instance will get a Public IP.</p>
</li>
<li><p><a name="availability_zone" /><a href="#availability_zone"><code>availability_zone</code></a> (string) - Destination availability zone to launch
instance in. Leave this empty to allow Amazon to auto-assign.</p>
</li>
<li><p><a name="block_duration_minutes" /><a href="#block_duration_minutes"><code>block_duration_minutes</code></a> (int64) - Requires <code>spot_price</code> to be set. The
required duration for the Spot Instances (also known as Spot blocks). This
value must be a multiple of 60 (60, 120, 180, 240, 300, or 360). You can&#39;t
specify an Availability Zone group or a launch group if you specify a
duration.</p>
</li>
<li><p><a name="bundle_destination" /><a href="#bundle_destination"><code>bundle_destination</code></a> (string) - The directory on the running instance where
the bundled AMI will be saved prior to uploading. By default this is
<code>/tmp</code>. This directory must exist and be writable.</p>
</li>
<li><p><a name="bundle_prefix" /><a href="#bundle_prefix"><code>bundle_prefix</code></a> (string) - The prefix for files created from bundling the
root volume. By default this is <code>image-{{timestamp}}</code>. The <code>timestamp</code>
variable should be used to make sure this is unique, otherwise it can
collide with other created AMIs by Packer in your account.</p>
</li>
<li><p><a name="bundle_upload_command" /><a href="#bundle_upload_command"><code>bundle_upload_command</code></a> (string) - The command to use to upload the bundled
volume. See the &quot;custom bundle commands&quot; section below for more
information.</p>
</li>
<li><p><a name="bundle_vol_command" /><a href="#bundle_vol_command"><code>bundle_vol_command</code></a> (string) - The command to use to bundle the volume.
See the &quot;custom bundle commands&quot; section below for more information.</p>
</li>
<li><p><a name="custom_endpoint_ec2" /><a href="#custom_endpoint_ec2"><code>custom_endpoint_ec2</code></a> (string) - This option is useful if you use a cloud
provider whose API is compatible with aws EC2. Specify another endpoint
like this <code>https://ec2.custom.endpoint.com</code>.</p>
</li>
<li><p><a name="decode_authorization_messages" /><a href="#decode_authorization_messages"><code>decode_authorization_messages</code></a> (boolean) - Enable automatic decoding of
any encoded authorization (error) messages using the
<code>sts:DecodeAuthorizationMessage</code> API. Note: requires that the effective
user/role have permissions to <code>sts:DecodeAuthorizationMessage</code> on resource
<code>*</code>. Default <code>false</code>.</p>
</li>
<li><p><a name="ebs_optimized" /><a href="#ebs_optimized"><code>ebs_optimized</code></a> (boolean) - Mark instance as <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSOptimized.html">EBS
Optimized</a>.
Default <code>false</code>.</p>
</li>
<li><p><a name="ena_support" /><a href="#ena_support"><code>ena_support</code></a> (boolean) - Enable enhanced networking (ENA but not
SriovNetSupport) on HVM-compatible AMIs. If set, add
<code>ec2:ModifyInstanceAttribute</code> to your AWS IAM policy. If false, this will
disable enhanced networking in the final AMI as opposed to passing the
setting through unchanged from the source. Note: you must make sure
enhanced networking is enabled on your instance. See <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/enhanced-networking.html#enabling_enhanced_networking">Amazon&#39;s
documentation on enabling enhanced
networking</a>.</p>
</li>
<li><p><a name="enable_t2_unlimited" /><a href="#enable_t2_unlimited"><code>enable_t2_unlimited</code></a> (boolean) - Enabling T2 Unlimited allows the source
instance to burst additional CPU beyond its available <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/t2-credits-baseline-concepts.html">CPU
Credits</a>
for as long as the demand exists. This is in contrast to the standard
configuration that only allows an instance to consume up to its available
CPU Credits. See the AWS documentation for <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/t2-unlimited.html">T2
Unlimited</a>
and the <strong>T2 Unlimited Pricing</strong> section of the <a href="https://aws.amazon.com/ec2/pricing/on-demand/">Amazon EC2 On-Demand
Pricing</a> document for more
information. By default this option is disabled and Packer will set up a
<a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/t2-std.html">T2
Standard</a>
instance instead.</p>
<p>To use T2 Unlimited you must use a T2 instance type, e.g. <code>t2.micro</code>.
Additionally, T2 Unlimited cannot be used in conjunction with Spot
Instances, e.g. when the <code>spot_price</code> option has been configured.
Attempting to do so will cause an error.</p>
<div class="alert alert-danger" role="alert">
<p><strong>Warning!</strong> Additional costs may be incurred by enabling T2
Unlimited - even for instances that would usually qualify for the <a href="https://aws.amazon.com/free/">AWS Free
Tier</a>.</p>
</div>
</li>
<li><p><a name="force_deregister" /><a href="#force_deregister"><code>force_deregister</code></a> (boolean) - Force Packer to first deregister an existing
AMI if one with the same name already exists. Defaults to <code>false</code>.</p>
</li>
<li><p><a name="force_delete_snapshot" /><a href="#force_delete_snapshot"><code>force_delete_snapshot</code></a> (boolean) - Force Packer to delete snapshots
associated with AMIs, which have been deregistered by <code>force_deregister</code>.
Defaults to <code>false</code>.</p>
</li>
<li><p><a name="iam_instance_profile" /><a href="#iam_instance_profile"><code>iam_instance_profile</code></a> (string) - The name of an <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/instance-profiles.html">IAM instance
profile</a>
to launch the EC2 instance with.</p>
</li>
<li><p><a name="launch_block_device_mappings" /><a href="#launch_block_device_mappings"><code>launch_block_device_mappings</code></a> (array of block device mappings) - Add one
or more block devices before the Packer build starts. If you add instance
store volumes or EBS volumes in addition to the root device volume, the
created AMI will contain block device mapping information for those
volumes. Amazon creates snapshots of the source instance&#39;s root volume and
any other EBS volumes described here. When you launch an instance from this
new AMI, the instance automatically launches with these additional volumes,
and will restore them from snapshots taken from the source instance.</p>
</li>
<li><p><a name="mfa_code" /><a href="#mfa_code"><code>mfa_code</code></a> (string) - The MFA
<a href="https://en.wikipedia.org/wiki/Time-based_One-time_Password_Algorithm">TOTP</a>
code. This should probably be a user variable since it changes all the
time.</p>
</li>
<li><p><a name="profile" /><a href="#profile"><code>profile</code></a> (string) - The profile to use in the shared credentials file for
AWS. See Amazon&#39;s documentation on <a href="https://docs.aws.amazon.com/sdk-for-go/v1/developer-guide/configuring-sdk.html#specifying-profiles">specifying
profiles</a>
for more details.</p>
</li>
<li><p><a name="region_kms_key_ids" /><a href="#region_kms_key_ids"><code>region_kms_key_ids</code></a> (map of strings) - a map of regions to copy the ami
to, along with the custom kms key id (alias or arn) to use for encryption
for that region. Keys must match the regions provided in <code>ami_regions</code>. If
you just want to encrypt using a default ID, you can stick with
<code>kms_key_id</code> and <code>ami_regions</code>. If you want a region to be encrypted with
that region&#39;s default key ID, you can use an empty string <code>&quot;&quot;</code> instead of a
key id in this map. (e.g. <code>&quot;us-east-1&quot;: &quot;&quot;</code>) However, you cannot use
default key IDs if you are using this in conjunction with <code>snapshot_users</code>
-- in that situation you must use custom keys. For valid formats see
<em>KmsKeyId</em> in the <a href="https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CopyImage.html">AWS API docs -
CopyImage</a>.</p>
</li>
<li><p><a name="run_tags" /><a href="#run_tags"><code>run_tags</code></a> (object of key/value strings) - Tags to apply to the instance
that is <em>launched</em> to create the AMI. These tags are <em>not</em> applied to the
resulting AMI unless they&#39;re duplicated in <code>tags</code>. This is a <a href="/docs/templates/engine.html">template
engine</a>, see <a href="#build-template-data">Build template
data</a> for more information.</p>
</li>
<li><p><a name="security_group_id" /><a href="#security_group_id"><code>security_group_id</code></a> (string) - The ID (<em>not</em> the name) of the security
group to assign to the instance. By default this is not set and Packer will
automatically create a new temporary security group to allow SSH access.
Note that if this is specified, you must be sure the security group allows
access to the <code>ssh_port</code> given below.</p>
</li>
<li><p><a name="security_group_ids" /><a href="#security_group_ids"><code>security_group_ids</code></a> (array of strings) - A list of security groups as
described above. Note that if this is specified, you must omit the
<code>security_group_id</code>.</p>
</li>
<li><p><a name="security_group_filter" /><a href="#security_group_filter"><code>security_group_filter</code></a> (object) - Filters used to populate the
<code>security_group_ids</code> field. Example:</p>
<div class="highlight"><pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"security_group_filter"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"filters"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"tag:Class"</span><span class="p">:</span><span class="w"> </span><span class="s2">"packer"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><p>This selects the SG&#39;s with tag <code>Class</code> with the value <code>packer</code>.</p>

<ul>
<li>  <code>filters</code> (map of strings) - filters used to select a
<code>security_group_ids</code>. Any filter described in the docs for
<a href="https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeSecurityGroups.html">DescribeSecurityGroups</a>
is valid.
</li>
</ul>
<p><code>security_group_ids</code> take precedence over this.</p>
</li>
<li><p><a name="skip_region_validation" /><a href="#skip_region_validation"><code>skip_region_validation</code></a> (boolean) - Set to true if you want to skip
validation of the region configuration option. Defaults to <code>false</code>.</p>
</li>
<li><p><a name="snapshot_groups" /><a href="#snapshot_groups"><code>snapshot_groups</code></a> (array of strings) - A list of groups that have access to
create volumes from the snapshot(s). By default no groups have permission
to create volumes form the snapshot(s). <code>all</code> will make the snapshot
publicly accessible.</p>
</li>
<li><p><a name="snapshot_users" /><a href="#snapshot_users"><code>snapshot_users</code></a> (array of strings) - A list of account IDs that have
access to create volumes from the snapshot(s). By default no additional
users other than the user creating the AMI has permissions to create
volumes from the backing snapshot(s).</p>
</li>
<li><p><a name="source_ami_filter" /><a href="#source_ami_filter"><code>source_ami_filter</code></a> (object) - Filters used to populate the <code>source_ami</code>
field. Example:</p>
<div class="highlight"><pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"source_ami_filter"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"filters"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"virtualization-type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"hvm"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ubuntu/images/*ubuntu-xenial-16.04-amd64-server-*"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"root-device-type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ebs"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"owners"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"099720109477"</span><span class="p">],</span><span class="w">
    </span><span class="s2">"most_recent"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><p>This selects the most recent Ubuntu 16.04 HVM EBS AMI from Canonical. NOTE:
This will fail unless <em>exactly</em> one AMI is returned. In the above example,
<code>most_recent</code> will cause this to succeed by selecting the newest image.</p>

<ul>
<li>  <code>filters</code> (map of strings) - filters used to select a <code>source_ami</code>.
NOTE: This will fail unless <em>exactly</em> one AMI is returned. Any filter
described in the docs for
<a href="http://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeImages.html">DescribeImages</a>
is valid.
</li>
<li>  <code>owners</code> (array of strings) - Filters the images by their owner. You
may specify one or more AWS account IDs, &quot;self&quot; (which will use the
account whose credentials you are using to run Packer), or an AWS owner
alias: for example, &quot;amazon&quot;, &quot;aws-marketplace&quot;, or &quot;microsoft&quot;. This
option is required for security reasons.
</li>
<li>  <code>most_recent</code> (boolean) - Selects the newest created image when true.
This is most useful for selecting a daily distro build.
</li>
</ul>
<p>You may set this in place of <code>source_ami</code> or in conjunction with it. If you
set this in conjunction with <code>source_ami</code>, the <code>source_ami</code> will be added
to the filter. The provided <code>source_ami</code> must meet all of the filtering
criteria provided in <code>source_ami_filter</code>; this pins the AMI returned by the
filter, but will cause Packer to fail if the <code>source_ami</code> does not exist.</p>
</li>
<li><p><a name="snapshot_tags" /><a href="#snapshot_tags"><code>snapshot_tags</code></a> (object of key/value strings) - Tags to apply to snapshot.
They will override AMI tags if already applied to snapshot.</p>
</li>
<li><p><a name="spot_price" /><a href="#spot_price"><code>spot_price</code></a> (string) - The maximum hourly price to launch a spot instance
to create the AMI. It is a type of instances that EC2 starts when the
maximum price that you specify exceeds the current spot price. Spot price
will be updated based on available spot instance capacity and current spot
Instance requests. It may save you some costs. You can set this to <code>auto</code>
for Packer to automatically discover the best spot price or to <code>0</code> to use
an on-demand instance (default).</p>
</li>
<li><p><a name="spot_price_auto_product" /><a href="#spot_price_auto_product"><code>spot_price_auto_product</code></a> (string) - Required if <code>spot_price</code> is set to
<code>auto</code>. This tells Packer what sort of AMI you&#39;re launching to find the
best spot price. This must be one of: <code>Linux/UNIX</code>, <code>SUSE Linux</code>,
<code>Windows</code>, <code>Linux/UNIX (Amazon VPC)</code>, <code>SUSE Linux (Amazon VPC)</code>,
<code>Windows (Amazon VPC)</code></p>
</li>
<li><p><a name="spot_tags" /><a href="#spot_tags"><code>spot_tags</code></a> (object of key/value strings) - Requires <code>spot_price</code> to be
set. This tells Packer to apply tags to the spot request that is issued.</p>
</li>
<li><p><a name="sriov_support" /><a href="#sriov_support"><code>sriov_support</code></a> (boolean) - Enable enhanced networking (SriovNetSupport but
not ENA) on HVM-compatible AMIs. If true, add <code>ec2:ModifyInstanceAttribute</code>
to your AWS IAM policy. Note: you must make sure enhanced networking is
enabled on your instance. See <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/enhanced-networking.html#enabling_enhanced_networking">Amazon&#39;s documentation on enabling enhanced
networking</a>.
Default <code>false</code>.</p>
</li>
<li><p><a name="ssh_keypair_name" /><a href="#ssh_keypair_name"><code>ssh_keypair_name</code></a> (string) - If specified, this is the key that will be
used for SSH with the machine. The key must match a key pair name loaded up
into Amazon EC2. By default, this is blank, and Packer will generate a
temporary key pair unless
<a href="/docs/templates/communicator.html#ssh_password"><code>ssh_password</code></a> is used.
<a href="/docs/templates/communicator.html#ssh_private_key_file"><code>ssh_private_key_file</code></a>
or <code>ssh_agent_auth</code> must be specified when <code>ssh_keypair_name</code> is utilized.</p>
</li>
<li><p><a name="ssh_agent_auth" /><a href="#ssh_agent_auth"><code>ssh_agent_auth</code></a> (boolean) - If true, the local SSH agent will be used to
authenticate connections to the source instance. No temporary key pair will
be created, and the values of <code>ssh_password</code> and <code>ssh_private_key_file</code>
will be ignored. To use this option with a key pair already configured in
the source AMI, leave the <code>ssh_keypair_name</code> blank. To associate an
existing key pair in AWS with the source instance, set the
<code>ssh_keypair_name</code> field to the name of the key pair.</p>
</li>
<li><p><a name="ssh_private_ip" /><a href="#ssh_private_ip"><code>ssh_private_ip</code></a> (boolean) - No longer supported. See
<a href="#ssh_interface"><code>ssh_interface</code></a>. A fixer exists to migrate.</p>
</li>
<li><p><a name="ssh_interface" /><a href="#ssh_interface"><code>ssh_interface</code></a> (string) - One of <code>public_ip</code>, <code>private_ip</code>, <code>public_dns</code>
or <code>private_dns</code>. If set, either the public IP address, private IP address,
public DNS name or private DNS name will used as the host for SSH. The
default behaviour if inside a VPC is to use the public IP address if
available, otherwise the private IP address will be used. If not in a VPC
the public DNS name will be used. Also works for WinRM.</p>
<p>Where Packer is configured for an outbound proxy but WinRM traffic should
be direct, <code>ssh_interface</code> must be set to <code>private_dns</code> and
<code>&lt;region&gt;.compute.internal</code> included in the <code>NO_PROXY</code> environment
variable.</p>
</li>
<li><p><a name="subnet_id" /><a href="#subnet_id"><code>subnet_id</code></a> (string) - If using VPC, the ID of the subnet, such as
<code>subnet-12345def</code>, where Packer will launch the EC2 instance. This field is
required if you are using an non-default VPC.</p>
</li>
<li><p><a name="subnet_filter" /><a href="#subnet_filter"><code>subnet_filter</code></a> (object) - Filters used to populate the <code>subnet_id</code> field.
Example:</p>
<div class="highlight"><pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"subnet_filter"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"filters"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"tag:Class"</span><span class="p">:</span><span class="w"> </span><span class="s2">"build"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"most_free"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"random"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><p>This selects the Subnet with tag <code>Class</code> with the value <code>build</code>, which has
the most free IP addresses. NOTE: This will fail unless <em>exactly</em> one
Subnet is returned. By using <code>most_free</code> or <code>random</code> one will be selected
from those matching the filter.</p>

<ul>
<li>  <code>filters</code> (map of strings) - filters used to select a <code>subnet_id</code>.
NOTE: This will fail unless <em>exactly</em> one Subnet is returned. Any
filter described in the docs for
<a href="https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeSubnets.html">DescribeSubnets</a>
is valid.
</li>
<li>  <code>most_free</code> (boolean) - The Subnet with the most free IPv4 addresses
will be used if multiple Subnets matches the filter.
</li>
<li>  <code>random</code> (boolean) - A random Subnet will be used if multiple Subnets
matches the filter. <code>most_free</code> have precendence over this.
</li>
</ul>
<p><code>subnet_id</code> take precedence over this.</p>
</li>
<li><p><a name="tags" /><a href="#tags"><code>tags</code></a> (object of key/value strings) - Tags applied to the AMI. This is a
<a href="/docs/templates/engine.html">template engine</a>, see <a href="#build-template-data">Build template
data</a> for more information.</p>
</li>
<li><p><a name="temporary_key_pair_name" /><a href="#temporary_key_pair_name"><code>temporary_key_pair_name</code></a> (string) - The name of the temporary key pair to
generate. By default, Packer generates a name that looks like
<code>packer_&lt;UUID&gt;</code>, where &lt;UUID&gt; is a 36 character unique identifier.</p>
</li>
<li><p><a name="temporary_security_group_source_cidr" /><a href="#temporary_security_group_source_cidr"><code>temporary_security_group_source_cidr</code></a> (string) - An IPv4 CIDR block to be
authorized access to the instance, when packer is creating a temporary
security group. The default is <code>0.0.0.0/0</code> (i.e., allow any IPv4 source).
This is only used when <code>security_group_id</code> or <code>security_group_ids</code> is not
specified.</p>
</li>
<li><p><a name="user_data" /><a href="#user_data"><code>user_data</code></a> (string) - User data to apply when launching the instance. Note
that you need to be careful about escaping characters due to the templates
being JSON. It is often more convenient to use <code>user_data_file</code>, instead.
Packer will not automatically wait for a user script to finish before
shutting down the instance this must be handled in a provisioner.</p>
</li>
<li><p><a name="user_data_file" /><a href="#user_data_file"><code>user_data_file</code></a> (string) - Path to a file that will be used for the user
data when launching the instance.</p>
</li>
<li><p><a name="vpc_id" /><a href="#vpc_id"><code>vpc_id</code></a> (string) - If launching into a VPC subnet, Packer needs the VPC ID
in order to create a temporary security group within the VPC. Requires
<code>subnet_id</code> to be set. If this field is left blank, Packer will try to get
the VPC ID from the <code>subnet_id</code>.</p>
</li>
<li><p><a name="vpc_filter" /><a href="#vpc_filter"><code>vpc_filter</code></a> (object) - Filters used to populate the <code>vpc_id</code> field.
Example:</p>
<div class="highlight"><pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"vpc_filter"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"filters"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"tag:Class"</span><span class="p">:</span><span class="w"> </span><span class="s2">"build"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"isDefault"</span><span class="p">:</span><span class="w"> </span><span class="s2">"false"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"cidr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/24"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><p>This selects the VPC with tag <code>Class</code> with the value <code>build</code>, which is not
the default VPC, and have a IPv4 CIDR block of <code>/24</code>. NOTE: This will fail
unless <em>exactly</em> one VPC is returned.</p>

<ul>
<li>  <code>filters</code> (map of strings) - filters used to select a <code>vpc_id</code>. NOTE:
This will fail unless <em>exactly</em> one VPC is returned. Any filter
described in the docs for
<a href="https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeVpcs.html">DescribeVpcs</a>
is valid.
</li>
</ul>
<p><code>vpc_id</code> take precedence over this.</p>
</li>
<li><p><a name="x509_upload_path" /><a href="#x509_upload_path"><code>x509_upload_path</code></a> (string) - The path on the remote machine where the X509
certificate will be uploaded. This path must already exist and be writable.
X509 certificates are uploaded after provisioning is run, so it is
perfectly okay to create this directory as part of the provisioning
process. Defaults to <code>/tmp</code>.</p>
</li>
<li><p><a name="windows_password_timeout" /><a href="#windows_password_timeout"><code>windows_password_timeout</code></a> (string) - The timeout for waiting for a Windows
password for Windows instances. Defaults to 20 minutes. Example value:
<code>10m</code></p>
</li>
</ul>
<h2 id="basic-example">
  <a name="basic-example" class="anchor" href="#basic-example">&raquo;</a>
  Basic Example
</h2>
<p>Here is a basic example. It is completely valid except for the access keys:</p>
<div class="highlight"><pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"amazon-instance"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"access_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"YOUR KEY HERE"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"secret_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"YOUR SECRET KEY HERE"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"region"</span><span class="p">:</span><span class="w"> </span><span class="s2">"us-east-1"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"source_ami"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ami-d9d6a6b0"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"instance_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"m1.small"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ssh_username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ubuntu"</span><span class="p">,</span><span class="w">

  </span><span class="s2">"account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0123-4567-0890"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"s3_bucket"</span><span class="p">:</span><span class="w"> </span><span class="s2">"packer-images"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"x509_cert_path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"x509.cert"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"x509_key_path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"x509.key"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"x509_upload_path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/tmp"</span><span class="p">,</span><span class="w">

  </span><span class="s2">"ami_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"packer-quick-start {{timestamp}}"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><div class="alert alert-info" role="alert">
<p><strong>Note:</strong> Packer can also read the access key and secret access key from
environmental variables. See the configuration reference in the section above
for more information on what environmental variables Packer will look for.</p>
</div>
<h2 id="accessing-the-instance-to-debug">
  <a name="accessing-the-instance-to-debug" class="anchor" href="#accessing-the-instance-to-debug">&raquo;</a>
  Accessing the Instance to Debug
</h2>
<p>If you need to access the instance to debug for some reason, run this builder
with the <code>-debug</code> flag. In debug mode, the Amazon builder will save the private
key in the current directory and will output the DNS or IP information as well.
You can use this information to access the instance as it is running.</p>
<h2 id="build-template-data">
  <a name="build-template-data" class="anchor" href="#build-template-data">&raquo;</a>
  Build template data
</h2>
<p>In configuration directives marked as a template engine above, the following
variables are available:</p>

<ul>
<li>  <code>BuildRegion</code> - The region (for example <code>eu-central-1</code>) where Packer is
building the AMI.
</li>
<li>  <code>SourceAMI</code> - The source AMI ID (for example <code>ami-a2412fcd</code>) used to build
the AMI.
</li>
<li>  <code>SourceAMIName</code> - The source AMI Name (for example
<code>ubuntu/images/ebs-ssd/ubuntu-xenial-16.04-amd64-server-20180306</code>) used to
build the AMI.
</li>
<li>  <code>SourceAMITags</code> - The source AMI Tags, as a <code>map[string]string</code> object.
</li>
</ul>
<h2 id="custom-bundle-commands">
  <a name="custom-bundle-commands" class="anchor" href="#custom-bundle-commands">&raquo;</a>
  Custom Bundle Commands
</h2>
<p>A lot of the process required for creating an instance-store backed AMI
involves commands being run on the actual source instance. Specifically, the
<code>ec2-bundle-vol</code> and <code>ec2-upload-bundle</code> commands must be used to bundle the
root filesystem and upload it, respectively.</p>
<p>Each of these commands have a lot of available flags. Instead of exposing each
possible flag as a template configuration option, the instance-store AMI
builder for Packer lets you customize the entire command used to bundle and
upload the AMI.</p>
<p>These are configured with <code>bundle_vol_command</code> and <code>bundle_upload_command</code>.
Both of these configurations are <a href="/docs/templates/engine.html">configuration
templates</a> and have support for their own set of
template variables.</p>
<h3 id="bundle-volume-command">
  <a name="bundle-volume-command" class="anchor" href="#bundle-volume-command">&raquo;</a>
  Bundle Volume Command
</h3>
<p>The default value for <code>bundle_vol_command</code> is shown below. It is split across
multiple lines for convenience of reading. The bundle volume command is
responsible for executing <code>ec2-bundle-vol</code> in order to store and image of the
root filesystem to use to create the AMI.</p>
<div class="highlight"><pre class="highlight plaintext"><code>sudo -i -n ec2-bundle-vol \
  -k {{.KeyPath}}  \
  -u {{.AccountId}} \
  -c {{.CertPath}} \
  -r {{.Architecture}} \
  -e {{.PrivatePath}}/* \
  -d {{.Destination}} \
  -p {{.Prefix}} \
  --batch \
  --no-filter
</code></pre></div><p>The available template variables should be self-explanatory based on the
parameters they&#39;re used to satisfy the <code>ec2-bundle-vol</code> command.</p>
<div class="alert alert-warning" role="alert">
<p><strong>Warning!</strong> Some versions of ec2-bundle-vol silently ignore all .pem
and .gpg files during the bundling of the AMI, which can cause problems on some
systems, such as Ubuntu. You may want to customize the bundle volume command to
include those files (see the <code>--no-filter</code> option of <code>ec2-bundle-vol</code>).</p>
</div>
<h3 id="bundle-upload-command">
  <a name="bundle-upload-command" class="anchor" href="#bundle-upload-command">&raquo;</a>
  Bundle Upload Command
</h3>
<p>The default value for <code>bundle_upload_command</code> is shown below. It is split
across multiple lines for convenience of reading. Access key and secret key are
omitted if using instance profile. The bundle upload command is responsible for
taking the bundled volume and uploading it to S3.</p>
<div class="highlight"><pre class="highlight plaintext"><code>sudo -i -n ec2-upload-bundle \
  -b {{.BucketName}} \
  -m {{.ManifestPath}} \
  -a {{.AccessKey}} \
  -s {{.SecretKey}} \
  -d {{.BundleDirectory}} \
  --batch \
  --region {{.Region}} \
  --retry
</code></pre></div><p>The available template variables should be self-explanatory based on the
parameters they&#39;re used to satisfy the <code>ec2-upload-bundle</code> command.
Additionally, <code>{{.Token}}</code> is available when overriding this command. You must
create your own bundle command with the addition of <code>-t {{.Token}}</code> if you are
assuming a role.</p>
<h4 id="bundle-upload-permissions">
  <a name="bundle-upload-permissions" class="anchor" href="#bundle-upload-permissions">&raquo;</a>
  Bundle Upload Permissions
</h4>
<p>The <code>ec2-upload-bundle</code> requires a policy document that looks something like
this:</p>
<div class="highlight"><pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"Version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-10-17"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"Statement"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"Effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"Action"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"s3:PutObject"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"s3:GetObject"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"s3:ListBucket"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"s3:GetBucketLocation"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"s3:PutObjectAcl"</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="s2">"Resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><p>You may wish to constrain the resource to a specific bucket.</p>


    </div>
  </div>
</div>


    <div id="footer" class="navigation hidden-print">
      <div class="container">
        <div class="row">
          <div class="col-xs-12">
            <ul class="footer-links nav navbar-nav">
              <li><a href="/intro/index.html">Intro</a></li>
              <li><a href="/guides/index.html">Guides</a></li>
              <li><a href="/docs/index.html">Docs</a></li>
              <li><a href="/community.html">Community</a></li>
              <li><a href="https://www.hashicorp.com/privacy">Privacy</a></li>
              <li><a href="/security.html">Security</a></li>
              <li><a href="/assets/files/press-kit.zip">Press Kit</a></li>
            </ul>
            <ul class="footer-links nav navbar-nav navbar-right">
              <li><a href="https://github.com/hashicorp/packer/blob/master/website/source/docs/builders/amazon-instance.html.md">Edit this page</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Product",
        "name": "Packer",
        "alternateName": "Packer by HashiCorp",
        "manufacturer": "HashiCorp",
        "url": "https://www.packer.io",
        "logo": "https://www.packer.io/assets/images/logo-hashicorp-e53df71d.svg",
        "sameAs": [
          "https://github.com/hashicorp/packer"
        ]
      }
    </script>
  </body>
</html>
